# QR Code Password Sharing Guide

## 🚀 Overview

The Advanced Password Manager now includes comprehensive QR code functionality for secure password sharing. This feature allows you to:

- **Generate QR codes** for any stored password
- **Share passwords securely** with optional password protection
- **Import passwords** from QR codes generated by others
- **Set expiry times** for shared passwords
- **Track sharing metadata** for security

## 📋 Menu Options

The QR code functionality is available through two new menu options:

```
16. Share Password via QR Code
17. Import Password from QR Code
```

## 🔐 Sharing Passwords via QR Code

### Step 1: Access the Feature
1. Launch the password manager: `pwd_manager_qr.exe`
2. Login with your master password
3. Select option **16** from the main menu

### Step 2: Select Password to Share
```
=== Share Password via QR Code ===
Enter service name: GitHub
Enter username: user@example.com
```

### Step 3: Choose Security Level
```
=== QR Code Options ===
1. Generate QR code without password protection
2. Generate QR code with password protection
Enter choice: 2
```

### Step 4: Configure Protection (if selected)
```
Enter share password: ********
Enter expiry time in hours (default 24): 48
```

### Step 5: View Generated QR Code
The system will display:
- **ASCII QR pattern** for scanning
- **QR code information** including expiry details
- **Instructions** for sharing and importing

## 📱 Importing Passwords from QR Code

### Step 1: Access the Feature
1. Select option **17** from the main menu

### Step 2: Paste QR Code Data
```
=== Import Password from QR Code ===
Paste the QR code text or scan result here:
(Press Enter twice to finish)
```

### Step 3: Enter Share Password (if protected)
```
Enter share password (if protected): ********
```

### Step 4: Review and Import
The system will display:
- **Password details** (password masked for security)
- **Metadata** including share ID and expiry
- **Import confirmation** prompt

## 🔧 Technical Implementation

### QR Code Data Structure
```cpp
struct QRCodeData {
    std::string service;           // Service/website name
    std::string username;          // Username/email
    std::string password;          // Encrypted password
    std::string notes;             // Additional notes
    std::string category;          // Organization category
    std::string expiry_date;       // Password expiry date
    std::string share_id;          // Unique share identifier
    std::string created_timestamp; // Creation time
    std::string expires_at;        // QR code expiry time
};
```

### Security Features

#### 1. **Password Protection**
- Optional share password for QR codes
- XOR encryption with Base64 encoding
- Secure key derivation from share password

#### 2. **Expiry Management**
- Configurable expiry time (default: 24 hours)
- Automatic expiry detection
- Timestamp validation

#### 3. **Data Validation**
- Complete data integrity checks
- Required field validation
- Format verification

#### 4. **Unique Identification**
- Random share ID generation
- Timestamp tracking
- Creation metadata

### QR Code Format

#### ASCII QR Pattern
```
=== QR Code Pattern ===
Scan this pattern with a QR code reader:

┌────────────────────────────────────────┐
│ PASSWORD_SHARE_V1                      │
│ SERVICE:GitHub                         │
│ USERNAME:user@example.com              │
│ PASSWORD:encrypted_password_data       │
│ NOTES:Personal account                 │
│ CATEGORY:Development                   │
│ EXPIRY:2024-12-31                     │
│ SHARE_ID:ABC12345                     │
│ CREATED:2024-01-15 14:30:25           │
│ EXPIRES_AT:2024-01-17 14:30:25        │
│ END_SHARE                              │
└────────────────────────────────────────┘

=== End QR Pattern ===
```

#### Data Format
```
PASSWORD_SHARE_V1
SERVICE:[service_name]
USERNAME:[username]
PASSWORD:[encrypted_password]
NOTES:[notes]
CATEGORY:[category]
EXPIRY:[expiry_date]
SHARE_ID:[unique_id]
CREATED:[timestamp]
EXPIRES_AT:[qr_expiry]
END_SHARE
```

## 🛡️ Security Considerations

### Encryption
- **XOR encryption** for share password protection
- **Base64 encoding** for safe text transmission
- **Key derivation** from share password

### Data Protection
- **Password masking** during import review
- **Secure input handling** for share passwords
- **Session-based access** control

### Expiry Management
- **Automatic expiry** detection
- **Timestamp validation** for security
- **Graceful handling** of expired codes

## 📊 Usage Examples

### Example 1: Basic Password Sharing
```
1. Select "Share Password via QR Code"
2. Enter service: "GitHub"
3. Enter username: "developer@company.com"
4. Choose option 1 (no protection)
5. Set expiry: 24 hours
6. Share the generated QR code
```

### Example 2: Protected Password Sharing
```
1. Select "Share Password via QR Code"
2. Enter service: "Bank Account"
3. Enter username: "user@bank.com"
4. Choose option 2 (with protection)
5. Enter share password: "secure123"
6. Set expiry: 2 hours
7. Share QR code + password separately
```

### Example 3: Importing Shared Password
```
1. Select "Import Password from QR Code"
2. Paste QR code data
3. Enter share password (if protected)
4. Review password details
5. Confirm import
6. Password added to manager
```

## 🔄 Workflow Integration

### Sharing Workflow
1. **Select password** to share
2. **Choose security level** (protected/unprotected)
3. **Set expiry time** for QR code
4. **Generate QR code** with metadata
5. **Share securely** with recipient
6. **Track sharing** with unique ID

### Import Workflow
1. **Receive QR code** from sender
2. **Paste QR data** into import function
3. **Enter share password** (if protected)
4. **Validate data** and check expiry
5. **Review password details**
6. **Confirm import** to password manager

## 🎯 Best Practices

### For Senders
- **Use password protection** for sensitive passwords
- **Set appropriate expiry times** (shorter for sensitive data)
- **Share passwords separately** from QR codes
- **Verify recipient identity** before sharing
- **Use secure channels** for sharing

### For Recipients
- **Verify sender identity** before importing
- **Check QR code expiry** before use
- **Review password details** before importing
- **Use secure channels** for receiving share passwords
- **Delete QR codes** after successful import

### Security Recommendations
- **Never share master passwords** via QR codes
- **Use unique share passwords** for each share
- **Set short expiry times** for sensitive data
- **Monitor sharing activity** regularly
- **Report suspicious activity** immediately

## 🔧 Troubleshooting

### Common Issues

#### QR Code Not Scanning
- **Check format**: Ensure ASCII pattern is complete
- **Verify data**: Check for corruption or truncation
- **Try manual entry**: Use import function with pasted data

#### Import Fails
- **Check expiry**: QR code may have expired
- **Verify password**: Share password may be incorrect
- **Validate data**: QR code may be corrupted

#### Password Protection Issues
- **Remember password**: Share passwords are not recoverable
- **Check format**: Ensure password matches exactly
- **Try again**: Re-enter password carefully

### Error Messages

#### "Invalid or corrupted QR code data"
- QR code format is incorrect
- Data has been corrupted
- Missing required fields

#### "This QR code has expired"
- QR code has passed its expiry time
- Request new QR code from sender

#### "A password for this service and username already exists"
- Password already exists in manager
- Choose to update or cancel import

## 🚀 Future Enhancements

### Planned Features
- **Real QR code generation** with proper libraries
- **Cloud sharing** capabilities
- **Batch sharing** for multiple passwords
- **Advanced encryption** (AES-256)
- **Sharing history** tracking
- **Revocation** capabilities

### API Integration
- **QR code libraries** for proper generation
- **Cloud storage** for sharing
- **Email integration** for notifications
- **Mobile app** synchronization

## 📄 File Structure

```
pswrd_mang/
├── include/
│   └── qr_code.h              # QR code functionality header
├── src/
│   ├── qr_code.cpp            # QR code implementation
│   └── main_simple.cpp        # Main application with QR features
├── pwd_manager_qr.exe         # Executable with QR functionality
└── QR_CODE_GUIDE.md           # This guide
```

---

**🎯 QR Code Password Sharing: Secure, Easy, and Feature-Rich!**
